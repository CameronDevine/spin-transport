%%
%% Automatically generated file from DocOnce source
%% (https://github.com/hplgit/doconce/)
%%

% #define PREAMBLE

% #ifdef PREAMBLE
%-------------------- begin preamble ----------------------

\documentclass[%
oneside,                 % oneside: electronic viewing, twoside: printing
final,                   % draft: marks overfull hboxes, figures with paths
10pt]{article}

\listfiles               %  print all files needed to compile this document

\usepackage{relsize,makeidx,color,setspace,amsmath,amsfonts,amssymb}
\usepackage[table]{xcolor}
\usepackage{bm,ltablex,microtype}

\usepackage[pdftex]{graphicx}

% Packages for typesetting blocks of computer code
\usepackage{fancyvrb,framed,moreverb}

% Define colors
\definecolor{orange}{cmyk}{0,0.4,0.8,0.2}
\definecolor{tucorange}{rgb}{1.0,0.64,0}
\definecolor{darkorange}{rgb}{.71,0.21,0.01}
\definecolor{darkgreen}{rgb}{.12,.54,.11}
\definecolor{myteal}{rgb}{.26, .44, .56}
\definecolor{gray}{gray}{0.45}
\definecolor{mediumgray}{gray}{.8}
\definecolor{lightgray}{gray}{.95}
\definecolor{brown}{rgb}{0.54,0.27,0.07}
\definecolor{purple}{rgb}{0.5,0.0,0.5}
\definecolor{darkgray}{gray}{0.25}
\definecolor{darkblue}{rgb}{0,0.08,0.45}
\definecolor{darkblue2}{rgb}{0,0,0.8}
\definecolor{lightred}{rgb}{1.0,0.39,0.28}
\definecolor{lightgreen}{rgb}{0.48,0.99,0.0}
\definecolor{lightblue}{rgb}{0.53,0.81,0.92}
\definecolor{lightblue2}{rgb}{0.3,0.3,1.0}
\definecolor{lightpurple}{rgb}{0.87,0.63,0.87}
\definecolor{lightcyan}{rgb}{0.5,1.0,0.83}

\colorlet{comment_green}{green!50!black}
\colorlet{string_red}{red!60!black}
\colorlet{keyword_pink}{magenta!70!black}
\colorlet{indendifier_green}{green!70!white}

% Backgrounds for code
\definecolor{cbg_gray}{rgb}{.95, .95, .95}
\definecolor{bar_gray}{rgb}{.92, .92, .92}

\definecolor{cbg_yellowgray}{rgb}{.95, .95, .85}
\definecolor{bar_yellowgray}{rgb}{.95, .95, .65}

\colorlet{cbg_yellow2}{yellow!10}
\colorlet{bar_yellow2}{yellow!20}

\definecolor{cbg_yellow1}{rgb}{.98, .98, 0.8}
\definecolor{bar_yellow1}{rgb}{.98, .98, 0.4}

\definecolor{cbg_red1}{rgb}{1, 0.85, 0.85}
\definecolor{bar_red1}{rgb}{1, 0.75, 0.85}

\definecolor{cbg_blue1}{rgb}{0.87843, 0.95686, 1.0}
\definecolor{bar_blue1}{rgb}{0.7,     0.95686, 1}

%\setlength{\fboxsep}{-1.5mm}  % adjust cod_vpad/pro_vpad background box

%% Background for code blocks (parameter is color name)

%% pro/cod_vpad: gives some vertical padding before and after the text
%% (but has more simplistic code than _cod/pro_tight+cod/pro).
%% pro/cod_vpad can be used to enclose Verbatim or lst begin/end for code.
%% pro/cod calls _pro/cod_tight and has very little vertical padding,
%% used to enclose Verbatim and other begin/end for code.
%% (pro/cod is what the ptex2tex program could produce with the
%% Blue/BlueBar definitions in .ptex2tex.cfg.)

\newenvironment{cod_vpad}[1]{
   \def\FrameCommand{\colorbox{#1}}
   \MakeFramed{\FrameRestore}}
   {\endMakeFramed}

\newenvironment{_cod_tight}[1]{
   \def\FrameCommand{\colorbox{#1}}
   \FrameRule0.6pt\MakeFramed {\FrameRestore}\vskip3mm}
   {\vskip0mm\endMakeFramed}

\newenvironment{cod}[1]{
\bgroup\rmfamily
\fboxsep=0mm\relax
\begin{_cod_tight}{#1}
\list{}{\parsep=-2mm\parskip=0mm\topsep=0pt\leftmargin=2mm
\rightmargin=2\leftmargin\leftmargin=4pt\relax}
\item\relax}
{\endlist\end{_cod_tight}\egroup}

%% Background for complete program blocks (parameter 1 is color name
%% for background, parameter 2 is color for left bar)
\newenvironment{pro_vpad}[2]{
   \def\FrameCommand{\color{#2}\vrule width 1mm\normalcolor\colorbox{#1}}
   \MakeFramed{\FrameRestore}}
   {\endMakeFramed}

\newenvironment{_pro_tight}[2]{
   \def\FrameCommand{\color{#2}\vrule width 1mm\normalcolor\colorbox{#1}}
   \FrameRule0.6pt\MakeFramed {\advance\hsize-2mm\FrameRestore}\vskip3mm}
   {\vskip0mm\endMakeFramed}

\newenvironment{pro}[2]{
\bgroup\rmfamily
\fboxsep=0mm\relax
\begin{_pro_tight}{#1}{#2}
\list{}{\parsep=-2mm\parskip=0mm\topsep=0pt\leftmargin=2mm
\rightmargin=2\leftmargin\leftmargin=4pt\relax}
\item\relax}
{\endlist\end{_pro_tight}\egroup}

\usepackage{minted}
\usemintedstyle{friendly}

\usepackage[T1]{fontenc}
%\usepackage[latin1]{inputenc}
\usepackage{ucs}
\usepackage[utf8x]{inputenc}

% Set palatino as the default font family:
\usepackage[sc]{mathpazo}    % Palatino fonts
\linespread{1.05}            % Palatino needs extra line spread to look nice

\usepackage{lmodern}         % Latin Modern fonts derived from Computer Modern

% Hyperlinks in PDF:
\definecolor{linkcolor}{rgb}{0,0,0.4}
\usepackage{hyperref}
\hypersetup{
    breaklinks=true,
    colorlinks=true,
    linkcolor=linkcolor,
    urlcolor=linkcolor,
    citecolor=black,
    filecolor=black,
    %filecolor=blue,
    pdfmenubar=true,
    pdftoolbar=true,
    bookmarksdepth=3   % Uncomment (and tweak) for PDF bookmarks with more levels than the TOC
    }
%\hyperbaseurl{}   % hyperlinks are relative to this root

\setcounter{tocdepth}{2}  % levels in table of contents

% --- fancyhdr package for fancy headers ---
\usepackage{fancyhdr}
\fancyhf{} % sets both header and footer to nothing
\renewcommand{\headrulewidth}{1pt}
% section name to the left (L) and page number to the right (R)
% on even (E) pages, the other way around on odd pages
% (switch twoside to onside in documentclass to just have odd pages)
\fancyhead[LE,RO]{\rightmark} % section
\fancyhead[RE,LO]{\thepage}
% Ensure copyright on titlepage (article style) and chapter pages (book style)
\fancypagestyle{plain}{
  \fancyhf{}
  \fancyfoot[C]{{\footnotesize \copyright\ 2017, Rico A.R. Picone. Released under CC Attribution 4.0 license}}
%  \renewcommand{\footrulewidth}{0mm}
  \renewcommand{\headrulewidth}{0mm}
}
% Ensure copyright on titlepages with \thispagestyle{empty}
\fancypagestyle{empty}{
  \fancyhf{}
  \fancyfoot[C]{{\footnotesize \copyright\ 2017, Rico A.R. Picone. Released under CC Attribution 4.0 license}}
  \renewcommand{\footrulewidth}{0mm}
  \renewcommand{\headrulewidth}{0mm}
}

\pagestyle{fancy}


% prevent orhpans and widows
\clubpenalty = 10000
\widowpenalty = 10000

% http://www.ctex.org/documents/packages/layout/titlesec.pdf
\usepackage{titlesec}  % needed for colored section headings
%\usepackage[compact]{titlesec}  % reduce the spacing around section headings


% --- color every two table rows ---
\let\oldtabular\tabular
\let\endoldtabular\endtabular
\definecolor{appleblue}{rgb}{0.93,0.95,1.0}  % Apple blue
\renewenvironment{tabular}{\rowcolors{2}{white}{appleblue}%
\oldtabular}{\endoldtabular}


% --- end of standard preamble for documents ---

% Custom LaTeX stuff in the preamble [from latex_preamble.tex]

% fonts
\usepackage[scaled=.92]{helvet}
%\usepackage[urw-garamond]{mathdesign}
%\usepackage[osf,sc]{mathpazo}
\usepackage{palatino}
\usepackage[T1]{fontenc}
\usepackage{eucal}  % nice mathcal fonts
\usepackage[small,euler-digits]{eulervm}
\usepackage{amsmath,amssymb}
\usepackage{tensor}
\usepackage{array} % for better arrays (eg matrices) in maths
\usepackage{inconsolata} % typewriter

% section head style
\usepackage{sectsty}
\allsectionsfont{\normalfont\sffamily\bfseries}
% \renewcommand{\abstractnamefont}{\normalfont\sffamily\bfseries}
\renewcommand{\abstractname}{\normalfont\sffamily\bfseries Abstract}

% title style ... this throws weird error
% \usepackage{titling}
% \pretitle{\sffamily\bfseries{}\begin{center}\sffamily\bfseries\LARGE\selectfont}
% \posttitle{\sffamily\bfseries{}\par\end{center}}
% \preauthor{\sffamily{}\begin{center}\normalfont\sffamily\selectfont}
% \postauthor{\sffamily{}\par\end{center}}
% \predate{\begin{center}\normalfont\sffamily\selectfont}
% \postdate{\par\end{center}}
% instead use doconce subst command

% TOC style
% \renewcommand{\cftsectionfont}{\normalfont\sffamily}
\let\oldtoc\tableofcontents
\renewcommand{\tableofcontents}{\sffamily\oldtoc}

% headers/footers
\fancypagestyle{fancy1}{%
	\renewcommand{\headrulewidth}{0pt} % customise the layout...
	\lhead{}\chead{}\rhead{}
	\lfoot{}\cfoot{}\rfoot{p~\thepage{}}
}%
\fancypagestyle{fancy2}{%
	\renewcommand{\headrulewidth}{0pt} % customise the layout...
	\lhead{}\chead{}\rhead{\S\slshape\nouppercase\leftmark}
	\lfoot{}\cfoot{}\rfoot{p~\thepage{}}
}%
\pagestyle{fancy2}

% insert custom LaTeX commands...

\raggedbottom
\makeindex
\usepackage[totoc]{idxlayout}   % for index in the toc
\usepackage[nottoc]{tocbibind}  % for references/bibliography in the toc

%-------------------- end preamble ----------------------

\begin{document}

% matching end for #ifdef PREAMBLE
% #endif

\newcommand{\exercisesection}[1]{\subsection*{#1}}


% ------------------- main content ----------------------



% ----------------- title -------------------------

\title{\sffamily\bfseries{}The \emph{spin-transport} documentation}

% ----------------- author(s) -------------------------

\author{\sffamily{}Rico A.R. Picone\footnote{Email: \texttt{rpicone@stmartin.edu}. Department of Mechanical Engineering, Saint Martin's University.}}

% ----------------- end author(s) -------------------------

\date{Aug 30, 2017}
\maketitle

\begin{abstract}
The \emph{spin-transport} software (\href{{https://github.com/ricopicone/spin-transport}}{GitHub}) is for the dynamic simulation of bulk spin transport---diffusion and separation---in solid media.
The project is open-source and still in development.
\end{abstract}

\tableofcontents


\vspace{1cm} % after toc





% !split
\section{Installation}
\label{section:installation}

\section{spin-transport: introduction}

This repository contains the (developing) open-source code for simulating bulk spin transport---diffusion and separation---in solid media. Multi-spin-species and magnetic resonance simulations are in development.

This is a \href{{https://www.python.org/}}{Python} and \href{{https://fenicsproject.org/}}{FEniCS} project. FEniCS is used to numerically solve the spin transport governing partial differential equations.

End users of this project write Python code to interface with FEniCS.

\subsection{Installation}

One must first have a working installation of FEniCS.
This README assumes the use of \href{{https://www.docker.com/}}{Docker} for installation, which is documented \href{{http://fenics.readthedocs.io/projects/containers/en/latest/}}{here}.

Then \href{{https://help.github.com/articles/cloning-a-repository/}}{clone} this repository to the host machine.

\subsection{Workflow}

The FEniCS docs have a section on \href{{http://fenics.readthedocs.io/projects/containers/en/latest/work_flows.html}}{workflow}.
There are many ways to instantiate these good practices, but if you're using a \*nix system, the following may be the easiest.

With the cloned \texttt{spin-transport} repository as your working directory, create a link in your path to \textbf{spin-transport}'s \texttt{fenics} executable bash script.

\begin{cod}{cbg_gray}\begin{minted}[fontsize=\fontsize{9pt}{9pt},linenos=false,baselinestretch=1.0,fontfamily=tt,xleftmargin=2mm]{bash}
ln fenics /usr/local/bin
\end{minted}
\end{cod}
\noindent

Now a FEniCS Python script \texttt{foo.py} can be started with the command \texttt{fenics foo.py} \textbf{from the host} instead of manually starting it from a Docker container.
This has several advantages, including that there is no need to move scripts into the container and that the complicated syntax need not be remembered.

\subsection{Testing the installation}

To verify that everything is installed correctly, run the Poisson equation demo \Verb!ft01_poisson.py! (\href{{https://fenicsproject.org/pub/tutorial/html/._ftut1004.html}}{source}) in your container.

If you installed the \texttt{fenics} bash script per the instructions above, you can use the following command (working directory: \texttt{spin-transport}).

\begin{cod}{cbg_gray}\begin{minted}[fontsize=\fontsize{9pt}{9pt},linenos=false,baselinestretch=1.0,fontfamily=tt,xleftmargin=2mm]{bash}
$ fenics ft01_poisson.py
\end{minted}
\end{cod}
\noindent

If everything is working fine, the output should look something like the following.

\begin{cod}{cbg_gray}\begin{minted}[fontsize=\fontsize{9pt}{9pt},linenos=false,baselinestretch=1.0,fontfamily=tt,xleftmargin=2mm]{bash}
$ fenics ft01_poisson.py
Calling DOLFIN just-in-time (JIT) compiler, this may take some time.
--- Instant: compiling ---
Calling FFC just-in-time (JIT) compiler, this may take some time.
Calling FFC just-in-time (JIT) compiler, this may take some time.
Calling FFC just-in-time (JIT) compiler, this may take some time.
Solving linear variational problem.
*** Warning: Degree of exact solution may be inadequate for accurate result in errornorm.
Calling FFC just-in-time (JIT) compiler, this may take some time.
Calling FFC just-in-time (JIT) compiler, this may take some time.
  Ignoring precision in integral metadata compiled using quadrature representation. Not implemented.
Calling FFC just-in-time (JIT) compiler, this may take some time.
Calling FFC just-in-time (JIT) compiler, this may take some time.
Calling FFC just-in-time (JIT) compiler, this may take some time.
error_L2  = 0.00823509807335
error_max = 1.33226762955e-15
\end{minted}
\end{cod}
\noindent

The directory \texttt{spin-transport/poisson} should have been created and should contain two files: \texttt{solution.pvd} and \texttt{solution000000.vtu}.
These files contain the solution data.

\subsection{Acknowledgement}

This work is supported by a grant from the Army Research Office, Materials Science Division under grant proposal \textbf{Nanoscale Spin Hyperpolarization and Imaging}
with PI \href{{http://marohn.chem.cornell.edu/}}{John Marohn, PhD}.

\subsection{Contributors}

This project stems from a collaboration among three institutions:

\begin{description}
\item[%s]
  [Cornell University](http://www.cornell.edu/),

\item[%s]
  [Saint Martin's University](https://www.stmartin.edu/), and the

\item[%s]
  [University of Washington](http://www.washington.edu/).
\end{description}

\noindent
The lead contributor to this project is \href{{http://ricopic.one}}{Rico Picone, PhD} of Saint Martin's University, co-PI on the ARO grant.
Other contributors include \href{{http://marohn.chem.cornell.edu/}}{John Marohn, PhD} (Cornell, PI), John A. Sidles, PhD (Washington), Joseph L. Garbini, PhD (Washington), and Corinne Isaac (Cornell).

\section{Short theoretical introduction}
\label{section:shorttheory}

Here's some code.

\begin{cod}{cbg_gray}\begin{minted}[fontsize=\fontsize{9pt}{9pt},linenos=false,mathescape,baselinestretch=1.0,fontfamily=tt,xleftmargin=2mm]{python}
x = 5
if x > 3:
  print('big!')
\end{minted}
\end{cod}
\noindent



\bibliographystyle{plain}
\bibliography{papers}


% ------------------- end of main content ---------------

% #ifdef PREAMBLE
\end{document}
% #endif

